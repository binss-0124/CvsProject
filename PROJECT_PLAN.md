# 편의점 종합 솔루션 v2.0 - 프로젝트 계획서

## 🎯 프로젝트 목표

편의점 종합 솔루션을 실제 비즈니스 워크플로우를 고려하여 체계적으로 리팩토링합니다.

### 핵심 개선사항
1. **실제 비즈니스 워크플로우 반영**
   - 점주 재고 부족 → 본사 재고 요청 → 본사 승인 → 물류 발송 → 재고 갱신
   - 고객 주문 → 점주 확인 → 제조/준비 → 픽업 알림 → 완료
   - 본사 상품 관리 → 지점별 가격 설정 → 재고 분배

2. **체계적인 디자인 시스템**
   - 각 역할별 전용 UI/UX
   - 일관된 디자인 언어
   - 반응형 및 접근성 고려

3. **확장 가능한 아키텍처**
   - 모듈화된 컴포넌트 구조
   - 타입 안전성 강화
   - 성능 최적화

## 🏗️ 시스템 아키텍처

### 사용자 역할별 기능

#### 1. 고객 (Customer)
- **주문 프로세스**: 지점 선택 → 상품 선택 → 장바구니 → 결제 → 픽업
- **주문 관리**: 주문 상태 추적, 주문 내역 조회, 리뷰 작성
- **프로필 관리**: 개인정보, 주소록, 결제수단 관리
- **알림**: 주문 상태 변경, 픽업 준비 완료 알림

#### 2. 점주 (Store Owner)
- **주문 관리**: 실시간 주문 접수, 상태 업데이트, 제조/준비 관리
- **재고 관리**: 현재 재고 확인, 재고 부족 알림, 재고 요청
- **매출 관리**: 일별/월별 매출 통계, 상품별 판매 분석
- **물류 관리**: 본사 재고 요청, 입고 확인, 재고 갱신

#### 3. 본사 (HQ)
- **지점 관리**: 지점 등록/수정/삭제, 지점별 성과 분석
- **상품 관리**: 상품 마스터 데이터, 가격 정책, 카테고리 관리
- **물류 관리**: 재고 요청 승인, 물류 발송, 입고 관리
- **매출 분석**: 전체 매출 통계, 지점별 성과, 상품별 분석

### 데이터베이스 설계

#### 핵심 테이블
1. **users** - 사용자 정보 (고객/점주/본사)
2. **stores** - 지점 정보
3. **products** - 상품 마스터 데이터
4. **store_products** - 지점별 상품 정보 (가격, 재고)
5. **orders** - 주문 정보
6. **order_items** - 주문 상품 상세
7. **inventory_requests** - 재고 요청
8. **inventory_transactions** - 재고 입출고 이력

## 📋 개발 단계별 계획

### Phase 1: 프로젝트 초기 설정 ✅ (완료)
- [x] Supabase 프로젝트 생성 및 설정
- [x] React + TypeScript + Vite 프로젝트 설정
- [x] 기본 디렉토리 구조 생성
- [x] 디자인 시스템 기반 설정
- [x] 기본 라우팅 설정

### Phase 2: 데이터베이스 설계 및 구현 (진행 중)
- [ ] 데이터베이스 스키마 설계
- [ ] 테이블 생성 및 관계 설정
- [ ] RLS 정책 설정
- [ ] 기본 데이터 시드 생성
- [ ] API 함수 구현

### Phase 3: 인증 및 권한 시스템 ✅ (완료)
- [x] Supabase Auth 설정
- [x] 역할별 권한 관리
- [x] 보호된 라우트 구현
- [x] 세션 관리

### Phase 4: 고객 기능 구현 (대기)
- [ ] 지점 선택 및 상품 카탈로그
- [ ] 장바구니 및 주문 시스템
- [ ] 주문 상태 추적
- [ ] 프로필 관리
- [ ] 알림 시스템

### Phase 5: 점주 기능 구현 (대기)
- [ ] 주문 관리 대시보드
- [ ] 재고 관리 시스템
- [ ] 재고 요청 프로세스
- [ ] 매출 분석
- [ ] 물류 관리

### Phase 6: 본사 기능 구현 (대기)
- [ ] 지점 관리
- [ ] 상품 마스터 데이터 관리
- [ ] 재고 요청 승인 시스템
- [ ] 전체 매출 분석
- [ ] 물류 관리

### Phase 7: 통합 및 최적화 (대기)
- [ ] 실시간 알림 시스템
- [ ] 성능 최적화
- [ ] 에러 처리 및 로깅
- [ ] 테스트 코드 작성
- [ ] 배포 준비

## 🎨 디자인 시스템

### 색상 팔레트
- **Primary (고객)**: #3B82F6 (파란색)
- **Secondary (점주)**: #10B981 (초록색)
- **Accent (본사)**: #8B5CF6 (보라색)
- **Neutral**: #6B7280 (회색)
- **Success**: #10B981 (초록색)
- **Warning**: #F59E0B (주황색)
- **Error**: #EF4444 (빨간색)

### 컴포넌트 시스템
- **Button**: Primary, Secondary, Ghost, Danger
- **Card**: Default, Elevated, Interactive
- **Input**: Text, Select, Textarea, File
- **Modal**: Default, Confirmation, Form
- **Table**: Default, Sortable, Paginated
- **Chart**: Line, Bar, Pie, Doughnut

### 레이아웃 시스템
- **Grid**: 12컬럼 그리드 시스템
- **Spacing**: 4px 단위 스페이싱
- **Typography**: 4단계 헤딩, 본문, 캡션
- **Breakpoints**: Mobile (320px), Tablet (768px), Desktop (1024px)

## 🚀 기술 스택

### Frontend
- **React 18+**: 최신 React 기능 활용
- **TypeScript**: 타입 안전성
- **Vite**: 빠른 개발 환경
- **React Router v6**: 라우팅
- **Zustand**: 상태 관리
- **Tailwind CSS**: 유틸리티 기반 스타일링
- **React Hook Form**: 폼 관리
- **React Query**: 서버 상태 관리

### Backend
- **Supabase**: PostgreSQL, Auth, Realtime, Storage
- **Row Level Security (RLS)**: 데이터 보안
- **Real-time subscriptions**: 실시간 업데이트
- **Edge Functions**: 서버리스 함수

### 개발 도구
- **ESLint**: 코드 품질
- **Prettier**: 코드 포맷팅
- **Vitest**: 테스트 프레임워크
- **Playwright**: E2E 테스트
- **Docker**: 컨테이너화

## 📊 성공 지표

### 기능적 지표
- [ ] 모든 비즈니스 워크플로우 구현 완료
- [ ] 실시간 알림 시스템 정상 작동
- [ ] 데이터 무결성 및 보안 확보
- [ ] 성능 최적화 (로딩 시간 < 2초)

### 사용자 경험 지표
- [ ] 직관적인 UI/UX 설계
- [ ] 반응형 디자인 완성
- [ ] 접근성 표준 준수
- [ ] 크로스 브라우저 호환성

### 개발 품질 지표
- [ ] TypeScript 타입 커버리지 100%
- [ ] 테스트 커버리지 80% 이상
- [ ] 코드 리뷰 및 문서화 완료
- [ ] CI/CD 파이프라인 구축

## ✅ 현재 완료된 작업

### Phase 1: 프로젝트 초기 설정 ✅
- [x] React + TypeScript + Vite 프로젝트 설정
- [x] Tailwind CSS 설정 및 커스텀 테마 구성
- [x] 기본 디렉토리 구조 생성
- [x] 공통 유틸리티 함수 구현
- [x] 기본 컴포넌트 시스템 구축
- [x] PostCSS 설정 및 Tailwind CSS 통합

### Phase 3: 인증 및 권한 시스템 ✅
- [x] Supabase 클라이언트 설정
- [x] 타입 정의 완료 (Database, Common Types)
- [x] Zustand 기반 인증 스토어 구현
- [x] 보호된 라우트 컴포넌트 구현
- [x] 로그인/회원가입 페이지 구현
- [x] 세션 관리 및 자동 로그인
- [x] **완전한 인증 시스템 구현** (2024-08-04 완료)
  - 회원가입 시 자동 프로필 생성
  - 로딩 상태 관리 최적화
  - 실시간 세션 동기화
  - 역할별 자동 리다이렉트
  - 포괄적인 오류 처리

### 기본 페이지 구현 ✅
- [x] 랜딩 페이지 (LandingPage)
- [x] 인증 페이지 (AuthPage) - 로그인/회원가입
- [x] 404 페이지 (NotFoundPage)
- [x] 기본 라우팅 설정

### 컴포넌트 시스템 ✅
- [x] Button 컴포넌트 (다양한 variant 지원)
- [x] LoadingSpinner 컴포넌트
- [x] ProtectedRoute 컴포넌트
- [x] 공통 유틸리티 함수 (formatDate, formatPrice 등)

### 역할별 페이지 및 컴포넌트 ✅
- [x] 고객 레이아웃 및 네비게이션
- [x] 점주 레이아웃 및 사이드바
- [x] 본사 레이아웃 및 사이드바
- [x] 모든 기본 페이지 컴포넌트

### Phase 2: 데이터베이스 설계 및 구현 ✅
- [x] **완전한 데이터베이스 스키마 설계** (2024-08-04 완료)
  - 실제 편의점 비즈니스 워크플로우 반영
  - 13개 핵심 테이블 구현 (profiles, stores, products, categories, orders, etc.)
  - 완전한 공급망 관리 시스템 (supply_requests, shipments, inventory_transactions)
  - 분석 및 알림 시스템 (notifications, daily_sales_summary, system_settings)
- [x] **포괄적인 RLS 정책 설정**
  - 역할 기반 데이터 접근 제어
  - 고객/점주/본사별 세분화된 권한 관리
- [x] **초기 데이터 시드 생성**
  - 19개 카테고리 (계층 구조 포함)
  - 19개 테스트 상품 (음료, 간식, 즉석식품)
  - 3개 테스트 지점 (강남점, 홍대점, 잠실점)
  - 57개 지점별 상품 재고 데이터
- [x] **자동화된 비즈니스 로직**
  - 주문 번호 자동 생성
  - 재고 자동 갱신 트리거
  - 주문 상태 이력 자동 기록
  - 매출 요약 자동 생성 함수
- [x] **프론트엔드 타입 정의 업데이트**
  - Supabase 자동 생성 타입 적용
  - 완전한 TypeScript 타입 안전성

## 🔄 다음 단계

### Phase 4: 고객 기능 구현 ✅
1. ✅ **지점 선택 및 위치 기반 서비스**
   - 3개 지점 표시 (강남점, 홍대점, 잠실점)
   - 지점별 상세 정보 (주소, 전화번호, 영업시간)
   - 배송/픽업 가능 여부 표시
   - 거리 계산 및 표시
   - 지점 선택 후 상품 페이지 이동

2. ✅ **상품 카탈로그 및 검색**
   - 7개 테스트 상품 표시 (할인, 재고부족, 품절 상품 포함)
   - 5개 카테고리별 필터링 (과자, 커피, 김밥, 탄산음료, 테스트)
   - 실시간 검색 기능
   - 상품 상세 정보 (가격, 브랜드, 할인율, 제조시간)
   - 재고 상태 표시 (재고부족, 품절 배지)

3. ✅ **장바구니 시스템**
   - 상품 추가/제거/수량 변경
   - 실시간 총 금액 계산 (상품금액 + 세금 + 배송비)
   - 지점별 장바구니 분리 (다른 지점 상품 추가 시 확인)
   - 주문 타입 선택 (픽업/배송)
   - 무료배송 조건 안내 (2만원 이상)
   - 장바구니 지속성 (새로고침 후에도 유지)

4. ✅ **실시간 재고 시스템** (추가 구현)
   - 장바구니 수량만큼 실시간 재고 차감 표시
   - 장바구니 수량 정보 표시
   - 재고 한계 검증 (실시간 재고 기준)
   - 상품 삭제 시 재고 복구
   - 상세한 재고 변동 로그

5. ✅ **주문 프로세스 (픽업/배송)**
   - 주문 확인 및 결제 페이지 구현
   - 픽업/배송 선택 및 배송 정보 입력
   - 결제 방법 선택 (신용카드/모바일/현금)
   - 실시간 금액 계산 (상품금액 + 세금 + 배송비)
   - 주문 번호 자동 생성 및 주문 데이터 저장
   - 장바구니-주문 페이지 연동 (선택사항 자동 적용)

6. ✅ **실시간 주문 상태 추적**
   - 주문 추적 페이지 (`/customer/orders/:orderId/tracking`)
   - 5단계 주문 진행 상황 표시 (접수→확인→준비→대기/배송→완료)
   - 픽업/배송별 다른 진행 단계 및 설명
   - "다음 단계" 버튼으로 상태 변경 시뮬레이션
   - 주문 상세 정보, 배송 정보, 결제 정보 표시
   - 주문 완료 후 자동으로 추적 페이지 이동

### Phase 5: 점주 기능 구현 🔄
1. **점주 대시보드 및 매출 통계**
   - 실시간 매출 현황 및 주요 지표
   - 일별/주별/월별 매출 차트
   - 인기 상품 및 재고 현황
   - 주문 접수 알림 시스템

2. **실시간 주문 관리**
   - 신규 주문 실시간 접수
   - 주문 상태 업데이트 (확인→준비→완료)
   - 픽업/배송 주문 구분 관리
   - 주문 상세 정보 및 고객 정보

3. **재고 관리 시스템**
   - 실시간 재고 현황 모니터링
   - 재고 부족 상품 알림
   - 재고 입출고 내역 관리
   - 안전 재고량 설정 및 관리

4. **본사 연동 및 발주 시스템**
   - 본사로 재고 요청 (Supply Request)
   - 발주 내역 및 배송 상태 추적
   - 자동 발주 설정 (최소 재고량 기준)

### Phase 6: 본사 기능 구현
1. 전체 지점 관리 대시보드
2. 상품 마스터 관리
3. 공급망 관리 (재고 요청 승인/거부)
4. 물류 관리 및 배송 추적
5. 전체 매출 분석 및 KPI

## 🚀 현재 상태

**개발 서버 실행 중**: `http://localhost:5173`

모든 기본 구조가 완성되어 개발 서버가 정상적으로 실행되고 있습니다. 다음 단계로 데이터베이스 설계를 진행할 수 있습니다.

---

**프로젝트 시작일**: 2024년 현재  
**예상 완료일**: 2-3주  
**담당자**: 개발팀  
**상태**: Phase 4 완전 완료 - 다음 단계: Phase 5 점주 기능 구현

## 📊 Phase 4 완료 현황 (2024년 8월 4일)

### ✅ 완료된 기능들
1. **지점 선택 시스템** (100%)
   - 3개 지점 표시 및 상세 정보
   - 위치 기반 거리 계산
   - 지점 선택 후 자동 이동

2. **상품 카탈로그 시스템** (100%)
   - 7개 테스트 상품 표시
   - 5개 카테고리 필터링
   - 실시간 검색 기능
   - 할인/재고부족/품절 상태 표시

3. **장바구니 시스템** (100%)
   - 상품 추가/제거/수량 변경
   - 실시간 총 금액 계산
   - 지점별 장바구니 분리
   - 주문 타입 선택 (픽업/배송)
   - 장바구니 지속성

4. **실시간 재고 시스템** (100%)
   - 장바구니 수량만큼 실시간 재고 차감
   - 재고 한계 검증
   - 상품 삭제 시 재고 복구

### ✅ 추가 완료된 기능들 (2024년 8월 4일 오후)

5. **주문 프로세스 시스템** (100%)
   - 주문 확인 및 결제 페이지 (`/customer/checkout`)
   - 픽업/배송 선택 및 배송 정보 입력
   - 결제 방법 선택 (신용카드/모바일/현금)
   - 실시간 금액 계산 및 이용약관 동의
   - 주문 번호 자동 생성 및 완료 처리

6. **주문 데이터 관리 시스템** (100%)
   - 주문 스토어 (`orderStore.ts`) 구현
   - 실시간 주문 내역 저장 및 표시
   - 주문 상태 관리 및 업데이트
   - localStorage 기반 데이터 지속성

7. **장바구니-주문 페이지 연동** (100%)
   - 픽업/배송 선택사항 자동 전달
   - 실시간 배송비 계산 (픽업: 0원, 배송: 조건부 무료)
   - 양방향 상태 동기화

8. **실시간 주문 추적 시스템** (100%)
   - 주문 추적 페이지 구현
   - 5단계 진행 상황 시각화
   - 픽업/배송별 맞춤형 진행 단계
   - 상태 변경 시뮬레이션 기능
   - 주문 완료 후 자동 이동

### 🎉 Phase 4 완전 완료!
**총 8개 주요 기능 시스템 구현 완료**
- ✅ 지점 선택 시스템
- ✅ 상품 카탈로그 시스템  
- ✅ 장바구니 시스템
- ✅ 실시간 재고 시스템
- ✅ 주문 프로세스 시스템
- ✅ 주문 데이터 관리 시스템
- ✅ 장바구니-주문 페이지 연동
- ✅ 실시간 주문 추적 시스템

### 🎉 Phase 4 완전 완료 요약 (2024년 8월 4일)

**완성된 고객 경험 시스템**:
- 🏪 지점 선택부터 주문 추적까지 완전한 쇼핑 플로우
- 🛒 실시간 재고 관리 및 장바구니 시스템
- 💳 완전한 주문 및 결제 프로세스
- 📱 실시간 주문 상태 추적 시스템
- 🔄 8개 핵심 시스템 완벽 연동

**기술적 성과**:
- TypeScript 완전 타입 안전성
- Zustand 상태 관리 + localStorage 지속성
- React Router v6 기반 SPA 구조
- Tailwind CSS 반응형 디자인
- 실시간 데이터 동기화

### 🚀 Phase 5: 점주 기능 구현 (진행 중)

#### ✅ 완료된 점주 기능 (2024년 8월 4일)

1. **점주 대시보드** (`/store`)
   - 실시간 매출 및 주문 현황 (오늘 매출, 주문 수, 처리 대기, 재고 부족)
   - 최근 7일 매출 차트 (막대 그래프)
   - 최근 주문 목록 (상태별 배지 표시)
   - 빠른 액션 버튼 (주문 관리, 재고 관리, 발주 요청, 매출 분석)
   - 실시간 업데이트 시간 표시

2. **실시간 주문 관리** (`/store/orders`)
   - 4개 탭 (신규 주문, 처리 중, 완료/취소, 전체)
   - 주문 상태별 필터링 및 개수 표시
   - 주문 상태 업데이트 (접수→확인→준비→완료)
   - 주문 취소 기능
   - 픽업/배송 구분 표시
   - 주문 상세 정보 (상품 목록, 배송지, 결제 정보) 